!function(){"use strict";var e={5251:function(e,t,s){var n=s(9196),r=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var a=Symbol.for;r=a("react.element"),t.Fragment=a("react.fragment")}var i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o=Object.prototype.hasOwnProperty,l={key:!0,ref:!0,__self:!0,__source:!0};function d(e,t,s){var n,a={},d=null,c=null;for(n in void 0!==s&&(d=""+s),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,n)&&!l.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:r,type:e,key:d,ref:c,props:a,_owner:i.current}}t.jsx=d,t.jsxs=d},5893:function(e,t,s){e.exports=s(5251)},9196:function(e){e.exports=window.React}},t={};function s(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,s),a.exports}!function(){var e,t=window.wp.element,n=new Uint8Array(16);function r(){if(!e&&!(e="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return e(n)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var i=function(e){return"string"===typeof e&&a.test(e)},o=[],l=0;l<256;++l)o.push((l+256).toString(16).substr(1));var d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=(o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]).toLowerCase();if(!i(s))throw TypeError("Stringified UUID is invalid");return s};var c=function(e,t,s){var n=(e=e||{}).random||(e.rng||r)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){s=s||0;for(var a=0;a<16;++a)t[s+a]=n[a];return t}return d(n)};const m=(e=[],t="")=>({id:t.length?t:c(),synonyms:e,valid:!0}),y=({sets:e,alternatives:t})=>{const s=[];return s.push("# Defined sets ( equivalent synonyms)."),s.push(...e.map((({synonyms:e})=>e.map((({value:e})=>e)).join(", ")))),s.push("\r"),s.push("# Defined alternatives (explicit mappings)."),s.push(...t.map((e=>!!e.synonyms.find((e=>e.primary&&e.value.length))&&e.synonyms.find((e=>e.primary)).value.concat(" => ").concat(e.synonyms.filter((e=>!e.primary)).map((({value:e})=>e)).join(", "))))),s.filter(Boolean).join("\n")},u=(e,t)=>{const s=(e,t=!1)=>({label:e,value:e,primary:t});return{...t,...e.split(/\r?\n/).reduce(((e,t)=>{if(0===t.indexOf("#")||!t.trim().length)return e;if(-1!==t.indexOf("=>")){const n=t.split("=>");return{...e,alternatives:[...e.alternatives,m([s(n[0].trim(),!0),...n[1].split(",").filter((e=>e.trim())).map((e=>s(e.trim())))])]}}return{...e,sets:[...e.sets,m([...t.split(",").filter((e=>e.trim())).map((e=>s(e.trim())))])]}}),{alternatives:[],sets:[]})}},{alternatives:p,sets:v,initialMode:h}=window.epSynonyms.data,x=v?v.map(m):[m()],E=p?p.map(m):[m()],f={isSolrEditable:"advanced"===h,isSolrVisible:"advanced"===h,alternatives:E,sets:x,solr:y({sets:x,alternatives:E}),dirty:!1,submit:!1},_=(e,t)=>{switch(t.type){case"ADD_SET":return{...e,sets:[...e.sets,m()],dirty:!0};case"UPDATE_SET":return{...e,sets:e.sets.map((e=>e.id!==t.data.id?e:m(t.data.tokens,t.data.id))),dirty:!0};case"REMOVE_SET":return{...e,sets:e.sets.filter((({id:e})=>e!==t.data)),dirty:!0};case"ADD_ALTERNATIVE":return{...e,alternatives:[...e.alternatives,m()],dirty:!0};case"UPDATE_ALTERNATIVE":return{...e,alternatives:[...e.alternatives.map((e=>e.id!==t.data.id?e:m([...t.data.tokens,...e.synonyms.filter((e=>e.primary))],t.data.id)))],dirty:!0};case"UPDATE_ALTERNATIVE_PRIMARY":return{...e,alternatives:[...e.alternatives.map((e=>e.id!==t.data.id?e:m([t.data.token,...e.synonyms.filter((e=>!e.primary))],t.data.id)))],dirty:!0};case"REMOVE_ALTERNATIVE":return{...e,alternatives:e.alternatives.filter((({id:e})=>e!==t.data)),dirty:!0};case"SET_SOLR_EDITABLE":return{...e,isSolrEditable:!!t.data,isSolrVisible:!!t.data};case"UPDATE_SOLR":return{...e,solr:t.data,dirty:!0};case"REDUCE_SOLR_TO_STATE":return{...u(e.solr,e),dirty:!0};case"REDUCE_STATE_TO_SOLR":return{...e,solr:y(e)};case"VALIDATE_ALL":return{...e,sets:e.sets.map((e=>({...e,valid:e.synonyms.length>1}))),alternatives:e.alternatives.map((e=>({...e,valid:e.synonyms.length>1&&!!e.synonyms.filter((({primary:e,value:t})=>e&&t.length)).length}))),dirty:!1};case"SUBMIT":return{...e,submit:!0};default:return e}};var T=s(5893);const j=(0,t.createContext)(),g=(0,t.createContext)(),A=e=>{const{children:s}=e,[n,r]=(0,t.useReducer)(_,f);return(0,T.jsx)(j.Provider,{value:n,children:(0,T.jsx)(g.Provider,{value:r,children:s})})};var S=window.wp.components;var b=({id:e,synonyms:s,removeAction:n,updateAction:r})=>{const a=(0,t.useContext)(g),{removeItemText:i}=window.epSynonyms.i18n;return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(S.FormTokenField,{label:null,onChange:t=>{const s=t.map((e=>({label:e,value:e,primary:!1})));a({type:r,data:{id:e,tokens:s}})},value:s.map((e=>e.value))},e),(0,T.jsxs)("button",{className:"synonym__remove",type:"button",onClick:()=>{a({type:n,data:e})},children:[(0,T.jsx)("span",{className:"dashicons dashicons-dismiss"}),(0,T.jsx)("span",{children:i})]})]})};var R=e=>{const{id:s,synonyms:n,removeAction:r,updateAction:a}=e,i=n.find((e=>e.primary)),[o,l]=(0,t.useState)(i?i.value:""),d=(0,t.useContext)(g),c=(0,t.useRef)(null);(0,t.useEffect)((()=>{var e;d({type:"UPDATE_ALTERNATIVE_PRIMARY",data:{id:s,token:(e=o,{label:e,value:e,primary:!0})}})}),[o,s,d]),(0,t.useEffect)((()=>{c.current.focus()}),[c]);const m=(0,t.useMemo)((()=>n.filter((e=>!e.primary))),[n]);return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("input",{type:"text",className:"ep-synonyms__input",onChange:e=>l(e.target.value),value:o,onKeyDown:e=>{if("Enter"===e.key)e.preventDefault()},ref:c}),(0,T.jsx)(b,{id:s,updateAction:a,removeAction:r,synonyms:m})]})};var N=({alternatives:e})=>{const s=(0,t.useContext)(g),n=(0,t.useContext)(j),{alternativesInputHeading:r,alternativesPrimaryHeading:a,alternativesAddButtonText:i,alternativesErrorMessage:o}=window.epSynonyms.i18n;return(0,T.jsx)("div",{className:"synonym-alternatives-editor metabox-holder",children:(0,T.jsxs)("div",{className:"postbox",children:[(0,T.jsxs)("h2",{className:"hndle",children:[(0,T.jsx)("span",{className:"synonym-alternatives__primary-heading",children:a}),(0,T.jsx)("span",{className:"synonym-alternatives__input-heading",children:r})]}),(0,T.jsxs)("div",{className:"inside",children:[e.map((e=>(0,T.jsxs)(t.Fragment,{children:[(0,T.jsx)("div",{className:"synonym-alternative-editor",children:(0,T.jsx)(R,{...e,updateAction:"UPDATE_ALTERNATIVE",removeAction:"REMOVE_ALTERNATIVE"})}),!e.valid&&(0,T.jsx)("p",{className:"synonym__validation",children:o})]},e.id))),(0,T.jsx)("button",{type:"button",className:"button button-secondary",onClick:t=>{const[r]=n.alternatives.slice(-1);e.length&&!r.synonyms.filter((({value:e})=>e.length)).length||s({type:"ADD_ALTERNATIVE"}),t.preventDefault()},children:i})]})]})})};var D=({sets:e})=>{const s=(0,t.useContext)(g),n=(0,t.useContext)(j),{setsInputHeading:r,setsAddButtonText:a,setsErrorMessage:i}=window.epSynonyms.i18n;return(0,T.jsx)("div",{className:"synonym-sets-editor metabox-holder",children:(0,T.jsxs)("div",{className:"postbox",children:[(0,T.jsx)("h2",{className:"hndle",children:(0,T.jsx)("span",{children:r})}),(0,T.jsxs)("div",{className:"inside",children:[e.map((e=>(0,T.jsxs)(t.Fragment,{children:[(0,T.jsx)("div",{className:"synonym-set-editor",children:(0,T.jsx)(b,{...e,updateAction:"UPDATE_SET",removeAction:"REMOVE_SET"})}),!e.valid&&(0,T.jsx)("p",{className:"synonym__validation",children:i})]},e.id))),(0,T.jsx)("button",{type:"button",className:"button button-secondary",onClick:t=>{const[r]=n.sets.slice(-1);e.length&&!r.synonyms.length||s({type:"ADD_SET"}),t.preventDefault()},children:a})]})]})})};var w=()=>{const e=(0,t.useContext)(j),s=(0,t.useContext)(g),{alternatives:n,isSolrEditable:r,isSolrVisible:a,sets:i,solr:o}=e,{synonymsTextareaInputName:l,solrInputHeading:d,solrAlternativesErrorMessage:c,solrSetsErrorMessage:m}=window.epSynonyms.i18n;return(0,T.jsx)("div",{className:"synonym-solr-editor metabox-holder "+(a?"":"hidden"),children:(0,T.jsxs)("div",{className:"postbox",children:[(0,T.jsx)("h2",{className:"hndle",children:(0,T.jsx)("span",{children:d})}),(0,T.jsxs)("div",{className:"inside",children:[(0,T.jsx)("textarea",{className:"large-text",id:"ep-synonym-input",name:l,rows:"20",value:o,readOnly:!r,onChange:e=>s({type:"UPDATE_SOLR",data:e.target.value})}),(0,T.jsxs)("div",{role:"region","aria-live":"assertive",className:"synonym-solr-editor__validation",children:[n.some((e=>!e.valid))&&(0,T.jsx)("p",{children:c}),i.some((e=>!e.valid))&&(0,T.jsx)("p",{children:m})]})]})]})})};var C=()=>{const e=(0,t.useContext)(j),s=(0,t.useContext)(g),{alternatives:n,sets:r,isSolrEditable:a,isSolrVisible:i,dirty:o,submit:l}=e,{pageHeading:d,pageDescription:c,pageToggleAdvanceText:m,pageToggleSimpleText:y,alternativesTitle:u,alternativesDescription:p,setsTitle:v,setsDescription:h,solrTitle:x,solrDescription:E,submitText:f}=window.epSynonyms.i18n;return(0,t.useEffect)((()=>{var t;l&&!o&&[...(t=e).sets,...t.alternatives].reduce(((e,t)=>e?t.valid:e),!0)&&document.querySelector(".wrap form").submit()}),[l,o,e]),(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("h1",{className:"wp-heading-inline",children:[d," ",(0,T.jsx)("button",{onClick:()=>{s(a?{type:"REDUCE_SOLR_TO_STATE"}:{type:"REDUCE_STATE_TO_SOLR"}),s({type:"SET_SOLR_EDITABLE",data:!a})},type:"button",className:"page-title-action",children:a?y:m})]}),(0,T.jsx)("p",{children:c}),!a&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("div",{className:"synonym-editor synonym-editor__sets",children:[(0,T.jsx)("h2",{children:`${v} (${r.length})`}),(0,T.jsx)("p",{children:h}),(0,T.jsx)(D,{sets:r})]}),(0,T.jsxs)("div",{className:"synonym-editor synonym-editor__alteratives",children:[(0,T.jsx)("h2",{children:`${u} (${n.length})`}),(0,T.jsx)("p",{children:p}),(0,T.jsx)(N,{alternatives:n})]})]}),(0,T.jsxs)("div",{className:"synonym-editor synonym-editor__solr",children:[i&&(0,T.jsx)("h2",{children:x}),i&&(0,T.jsx)("p",{children:E}),(0,T.jsx)(w,{})]}),(0,T.jsx)("input",{type:"hidden",name:"synonyms_editor_mode",value:a?"advanced":"simple"}),(0,T.jsx)("div",{className:"synonym-btn-group",children:(0,T.jsx)("button",{onClick:()=>{a&&s({type:"REDUCE_SOLR_TO_STATE"}),s({type:"VALIDATE_ALL"}),s({type:"REDUCE_STATE_TO_SOLR"}),s({type:"SUBMIT"})},type:"button",className:"button button-primary",children:f})})]})};(0,t.render)((0,T.jsx)(A,{children:(0,T.jsx)(C,{})}),document.querySelector("#synonym-root")||!1)}()}();