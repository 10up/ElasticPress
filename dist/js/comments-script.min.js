!function(){"use strict";var e,t=function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e},n=document.querySelectorAll(".ep-widget-search-comments");n.forEach((function(e){var t=document.createElement("input");t.setAttribute("autocomplete","off"),t.setAttribute("type","search"),t.setAttribute("class","ep-widget-search-comments-input");var n=document.createElement("ul");n.setAttribute("class","ep-widget-search-comments-results"),e.appendChild(t),e.appendChild(n)}));var i=[38,40,13];function o(n){e=void 0;for(var i=t(n,"ep-widget-search-comments").querySelector(".ep-widget-search-comments-results");i.firstChild;)i.removeChild(i.firstChild)}function r(e){var t,n=window.epc.minimumLengthToSearch||2;return(null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.trim().length)>=n}function c(e,n){var i=t(n,"ep-widget-search-comments");e?i.classList.add("ep-widget-search-comments-is-loading"):i.classList.remove("ep-widget-search-comments-is-loading")}var s=function(e,t){var n=null;return function(){for(var i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];var c=this;window.clearTimeout(n),n=window.setTimeout((function(){e.apply(c,o)}),t)}}((function(e){if(r(e)){var n=t(e,"ep-widget-search-comments").querySelector("#ep-widget-search-comments-post-type"),i=null!==n&&void 0!==n&&n.value?"&post_type=".concat(n.value.trim()):"";return c(!0,e),fetch("".concat(window.epc.restApiEndpoint,"?s=").concat(e.value.trim()).concat(i)).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(n){0===Object.keys(n).length?e.value.trim()?function(e){var n=t(e,"ep-widget-search-comments").querySelector(".ep-widget-search-comments-results"),i='<li class="ep-widget-search-comments-result-item-not-found">'.concat(window.epc.noResultsFoundText,"</li>");"undefined"!==typeof window.epCommentWidgetItemNotFoundHTMLFilter&&(i=window.epCommentWidgetItemNotFoundHTMLFilter(i,window.epc.noResultsFoundText,e.value)),n.innerHTML=i}(e):o(e):function(e,n){var i="",o="";Object.keys(e).forEach((function(t,r){var c,s;null!==(c=e[t])&&void 0!==c&&c.content&&null!==(s=e[t])&&void 0!==s&&s.link&&(o='\n\t\t\t\t<li class="ep-widget-search-comments-result-item">\n\t\t\t\t\t<a href="'.concat(e[t].link,'">\n\t\t\t\t\t\t').concat(e[t].content,"\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t"),"undefined"!==typeof window.epCommentWidgetItemHTMLFilter&&(o=window.epCommentWidgetItemHTMLFilter(o,e[t],r,n.value)),i+=o)}));var r=t(n,"ep-widget-search-comments").querySelector(".ep-widget-search-comments-results");"undefined"!==typeof window.epCommentWidgetItemsHTMLFilter&&(i=window.epCommentWidgetItemsHTMLFilter(i,n.value)),r.innerHTML=i}(n,e)})).catch((function(){o(e)})).finally((function(){c(!1,e)}))}return!1}),500),a=function(n){n.preventDefault();var c=n.target,a=n.key,u=n.keyCode;if("Escape"===a||"Esc"===a||27===u)return o(c),void c.setAttribute("aria-expanded",!1);i.includes(u)&&""!==c.value?function(n){var o,r,c;if(i.includes(n.keyCode)){var s=t(n.target,"ep-widget-search-comments").querySelector(".ep-widget-search-comments-results"),a=s.querySelectorAll(".ep-widget-search-comments-result-item").length,u=s.children,l=e;switch(n.keyCode){case 38:e=e-1<0||"undefined"===typeof e?a-1:e-1;break;case 40:"undefined"===typeof e||e+1>a-1?e=0:e+=1;break;case 13:if(null!==(o=u[e])&&void 0!==o&&o.classList.contains("selected")||1===a){var d=e||0;if(u[d]){var m,f=null===(m=u[d].querySelector("a"))||void 0===m?void 0:m.getAttribute("href");window.location.href=f}}}"number"===typeof l&&(u[l].classList.remove("selected"),u[l].setAttribute("aria-selected","false")),null===(r=u[e])||void 0===r||r.classList.add("selected"),null===(c=u[e])||void 0===c||c.setAttribute("aria-selected","true")}}(n):r(c)?s(c):o(c)};n.forEach((function(e){var t=e.querySelector(".ep-widget-search-comments-input");t.addEventListener("keyup",a),t.addEventListener("keydown",(function(e){38===e.keyCode&&e.preventDefault()})),t.addEventListener("blur",(function(){setTimeout((function(){return o(t)}),200)}))}))}();