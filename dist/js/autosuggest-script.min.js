!function(){"use strict";var t={};t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}();const e=(t,e)=>{let r=null;return function(...n){const o=this;window.clearTimeout(r),r=window.setTimeout((()=>{t.apply(o,n)}),e)}},r=(t,e)=>{for(;(t=t.parentElement)&&!t.classList.contains(e););return t};var n=function(t){var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){return e.reject(r)}))}))};var o=function(t){return new this((function(e,r){if(!t||"undefined"===typeof t.length)return r(new TypeError(typeof t+" "+t+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var o=n.length;function i(t,r){if(r&&("object"===typeof r||"function"===typeof r)){var s=r.then;if("function"===typeof s)return void s.call(r,(function(e){i(t,e)}),(function(r){n[t]={status:"rejected",reason:r},0===--o&&e(n)}))}n[t]={status:"fulfilled",value:r},0===--o&&e(n)}for(var s=0;s<n.length;s++)i(s,n[s])}))},i=setTimeout,s="undefined"!==typeof setImmediate?setImmediate:null;function a(t){return Boolean(t&&"undefined"!==typeof t.length)}function u(){}function c(t){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],y(t,this)}function l(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,c._immediateFn((function(){var r=1===t._state?e.onFulfilled:e.onRejected;if(null!==r){var n;try{n=r(t._value)}catch(t){return void d(e.promise,t)}f(e.promise,n)}else(1===t._state?f:d)(e.promise,t._value)}))):t._deferreds.push(e)}function f(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var r=e.then;if(e instanceof c)return t._state=3,t._value=e,void h(t);if("function"===typeof r)return void y((n=r,o=e,function(){n.apply(o,arguments)}),t)}t._state=1,t._value=e,h(t)}catch(e){d(t,e)}var n,o}function d(t,e){t._state=2,t._value=e,h(t)}function h(t){2===t._state&&0===t._deferreds.length&&c._immediateFn((function(){t._handled||c._unhandledRejectionFn(t._value)}));for(var e=0,r=t._deferreds.length;e<r;e++)l(t,t._deferreds[e]);t._deferreds=null}function p(t,e,r){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=r}function y(t,e){var r=!1;try{t((function(t){r||(r=!0,f(e,t))}),(function(t){r||(r=!0,d(e,t))}))}catch(t){if(r)return;r=!0,d(e,t)}}c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var r=new this.constructor(u);return l(this,new p(t,e,r)),r},c.prototype.finally=n,c.all=function(t){return new c((function(e,r){if(!a(t))return r(new TypeError("Promise.all accepts an array"));var n=Array.prototype.slice.call(t);if(0===n.length)return e([]);var o=n.length;function i(t,s){try{if(s&&("object"===typeof s||"function"===typeof s)){var a=s.then;if("function"===typeof a)return void a.call(s,(function(e){i(t,e)}),r)}n[t]=s,0===--o&&e(n)}catch(t){r(t)}}for(var s=0;s<n.length;s++)i(s,n[s])}))},c.allSettled=o,c.resolve=function(t){return t&&"object"===typeof t&&t.constructor===c?t:new c((function(e){e(t)}))},c.reject=function(t){return new c((function(e,r){r(t)}))},c.race=function(t){return new c((function(e,r){if(!a(t))return r(new TypeError("Promise.race accepts an array"));for(var n=0,o=t.length;n<o;n++)c.resolve(t[n]).then(e,r)}))},c._immediateFn="function"===typeof s&&function(t){s(t)}||function(t){i(t,0)},c._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var m=c,b=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof t.g)return t.g;throw new Error("unable to locate global object")}();"function"!==typeof b.Promise?b.Promise=m:(b.Promise.prototype.finally||(b.Promise.prototype.finally=n),b.Promise.allSettled||(b.Promise.allSettled=o));var g="undefined"!==typeof globalThis&&globalThis||"undefined"!==typeof self&&self||"undefined"!==typeof g&&g,w="URLSearchParams"in g,v="Symbol"in g&&"iterator"in Symbol,_="FileReader"in g&&"Blob"in g&&function(){try{return new Blob,!0}catch(t){return!1}}(),E="FormData"in g,T="ArrayBuffer"in g;if(T)var A=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],j=ArrayBuffer.isView||function(t){return t&&A.indexOf(Object.prototype.toString.call(t))>-1};function P(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(t)||""===t)throw new TypeError('Invalid character in header field name: "'+t+'"');return t.toLowerCase()}function B(t){return"string"!==typeof t&&(t=String(t)),t}function S(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v&&(e[Symbol.iterator]=function(){return e}),e}function x(t){this.map={},t instanceof x?t.forEach((function(t,e){this.append(e,t)}),this):Array.isArray(t)?t.forEach((function(t){this.append(t[0],t[1])}),this):t&&Object.getOwnPropertyNames(t).forEach((function(e){this.append(e,t[e])}),this)}function L(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function O(t){return new Promise((function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}}))}function U(t){var e=new FileReader,r=O(e);return e.readAsArrayBuffer(t),r}function C(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function k(){return this.bodyUsed=!1,this._initBody=function(t){var e;this.bodyUsed=this.bodyUsed,this._bodyInit=t,t?"string"===typeof t?this._bodyText=t:_&&Blob.prototype.isPrototypeOf(t)?this._bodyBlob=t:E&&FormData.prototype.isPrototypeOf(t)?this._bodyFormData=t:w&&URLSearchParams.prototype.isPrototypeOf(t)?this._bodyText=t.toString():T&&_&&((e=t)&&DataView.prototype.isPrototypeOf(e))?(this._bodyArrayBuffer=C(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):T&&(ArrayBuffer.prototype.isPrototypeOf(t)||j(t))?this._bodyArrayBuffer=C(t):this._bodyText=t=Object.prototype.toString.call(t):this._bodyText="",this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):w&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},_&&(this.blob=function(){var t=L(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){if(this._bodyArrayBuffer){var t=L(this);return t||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}return this.blob().then(U)}),this.text=function(){var t=L(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,r=O(e);return e.readAsText(t),r}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},E&&(this.formData=function(){return this.text().then(R)}),this.json=function(){return this.text().then(JSON.parse)},this}x.prototype.append=function(t,e){t=P(t),e=B(e);var r=this.map[t];this.map[t]=r?r+", "+e:e},x.prototype.delete=function(t){delete this.map[P(t)]},x.prototype.get=function(t){return t=P(t),this.has(t)?this.map[t]:null},x.prototype.has=function(t){return this.map.hasOwnProperty(P(t))},x.prototype.set=function(t,e){this.map[P(t)]=B(e)},x.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},x.prototype.keys=function(){var t=[];return this.forEach((function(e,r){t.push(r)})),S(t)},x.prototype.values=function(){var t=[];return this.forEach((function(e){t.push(e)})),S(t)},x.prototype.entries=function(){var t=[];return this.forEach((function(e,r){t.push([r,e])})),S(t)},v&&(x.prototype[Symbol.iterator]=x.prototype.entries);var D=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function F(t,e){if(!(this instanceof F))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var r=(e=e||{}).body;if(t instanceof F){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new x(t.headers)),this.method=t.method,this.mode=t.mode,this.signal=t.signal,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"same-origin",!e.headers&&this.headers||(this.headers=new x(e.headers)),this.method=function(t){var e=t.toUpperCase();return D.indexOf(e)>-1?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(r),("GET"===this.method||"HEAD"===this.method)&&("no-store"===e.cache||"no-cache"===e.cache)){var n=/([?&])_=[^&]*/;if(n.test(this.url))this.url=this.url.replace(n,"$1_="+(new Date).getTime());else{this.url+=(/\?/.test(this.url)?"&":"?")+"_="+(new Date).getTime()}}}function R(t){var e=new FormData;return t.trim().split("&").forEach((function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(o))}})),e}function I(t){var e=new x;return t.replace(/\r?\n[\t ]+/g," ").split("\r").map((function(t){return 0===t.indexOf("\n")?t.substr(1,t.length):t})).forEach((function(t){var r=t.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();e.append(n,o)}})),e}function q(t,e){if(!(this instanceof q))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText=void 0===e.statusText?"":""+e.statusText,this.headers=new x(e.headers),this.url=e.url||"",this._initBody(t)}F.prototype.clone=function(){return new F(this,{body:this._bodyInit})},k.call(F.prototype),k.call(q.prototype),q.prototype.clone=function(){return new q(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new x(this.headers),url:this.url})},q.error=function(){var t=new q(null,{status:0,statusText:""});return t.type="error",t};var N=[301,302,303,307,308];q.redirect=function(t,e){if(-1===N.indexOf(e))throw new RangeError("Invalid status code");return new q(null,{status:e,headers:{location:t}})};var $=g.DOMException;try{new $}catch(t){($=function(t,e){this.message=t,this.name=e;var r=Error(t);this.stack=r.stack}).prototype=Object.create(Error.prototype),$.prototype.constructor=$}function H(t,e){return new Promise((function(r,n){var o=new F(t,e);if(o.signal&&o.signal.aborted)return n(new $("Aborted","AbortError"));var i=new XMLHttpRequest;function s(){i.abort()}i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:I(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var e="response"in i?i.response:i.responseText;setTimeout((function(){r(new q(e,t))}),0)},i.onerror=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},i.ontimeout=function(){setTimeout((function(){n(new TypeError("Network request failed"))}),0)},i.onabort=function(){setTimeout((function(){n(new $("Aborted","AbortError"))}),0)},i.open(o.method,function(t){try{return""===t&&g.location.href?g.location.href:t}catch(e){return t}}(o.url),!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&(_?i.responseType="blob":T&&o.headers.get("Content-Type")&&-1!==o.headers.get("Content-Type").indexOf("application/octet-stream")&&(i.responseType="arraybuffer")),!e||"object"!==typeof e.headers||e.headers instanceof x?o.headers.forEach((function(t,e){i.setRequestHeader(e,t)})):Object.getOwnPropertyNames(e.headers).forEach((function(t){i.setRequestHeader(t,B(e.headers[t]))})),o.signal&&(o.signal.addEventListener("abort",s),i.onreadystatechange=function(){4===i.readyState&&o.signal.removeEventListener("abort",s)}),i.send("undefined"===typeof o._bodyInit?null:o._bodyInit)}))}H.polyfill=!0,g.fetch||(g.fetch=H,g.Headers=x,g.Request=F,g.Response=q);const{epas:M}=window;function G(t,e){e.setAttribute("aria-activedescendant",t)}function J(t,e){!function(t){const e=new CustomEvent("ep-autosuggest-click",{detail:t});if(window.dispatchEvent(e),t.searchTerm&&1===parseInt(M.triggerAnalytics,10)&&"function"===typeof gtag){const e=`click - ${t.searchTerm}`;gtag("event",e,{event_category:"EP :: Autosuggest",event_label:t.url,transport_type:"beacon"})}}({searchTerm:t,url:e}),window.location.href=e}function V(t,e){return"navigate"===M.action?J(t.value,e.dataset.url):(function(t,e){t.value=e}(t,e.innerText),function(t){t.closest("form").submit()}(t))}function X(t,e,{query:r}){const n=(o=e,i=t,r.replace(new RegExp((t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))(o),"g"),i));var o,i;return n}async function z(t,e){const r={body:t,method:"POST",mode:"cors",headers:{"Content-Type":"application/json; charset=utf-8"}};M?.http_headers&&"object"===typeof M.http_headers&&Object.keys(M.http_headers).forEach((t=>{r.headers[t]=M.http_headers[t]})),M.addSearchTermHeader&&(r.headers["EP-Search-Term"]=encodeURI(e));try{const t=await window.fetch(M.endpointUrl,r);if(!t.ok)throw Error(t.statusText);const n=await t.json();return"undefined"!==typeof window.epDataFilter?window.epDataFilter(n,e):n}catch(t){return console.error(t),t}}function Q(t,e){let n,o="";const{value:i}=e,s=r(e,"ep-autosuggest-container").querySelector(".ep-autosuggest"),a=s.querySelector(".autosuggest-list");for(;a.firstChild;)a.removeChild(a.firstChild);t.length>0?s.style="display: block;":s.style="display: none;";const u=t.length;for(n=0;u>n;++n){const e=t[n]._source.post_title,r=t[n]._source.permalink,s=e.replace(/\\([\s\S])|(")/g,"&quot;"),a=i.trim().split(" ");let u=s;if(M.highlightingEnabled){const t=new RegExp(`\\b(${a.join("|")})`,"gi");u=u.replace(t,(t=>`<${M.highlightingTag} class="${M.highlightingClass} ep-autosuggest-highlight">${t}</${M.highlightingTag}>`))}let c=`<li class="autosuggest-item" role="option" aria-selected="false" id="autosuggest-option-${n}">\n\t\t\t\t<a href="${r}" class="autosuggest-link" data-search="${s}" data-url="${r}"  tabindex="-1">\n\t\t\t\t\t${u}\n\t\t\t\t</a>\n\t\t\t</li>`;"undefined"!==typeof window.epAutosuggestItemHTMLFilter&&(c=window.epAutosuggestItemHTMLFilter(c,t[n],n,i)),o+=c}a.innerHTML=o;const c=Array.from(document.querySelectorAll(".autosuggest-link"));return a.addEventListener("click",(t=>{t.preventDefault();const r=t.target.tagName===M.highlightingTag?.toUpperCase()?t.target.parentElement:t.target;c.includes(r)&&V(e,r)})),!0}function K(){const t=document.querySelectorAll(".autosuggest-list"),e=document.querySelectorAll(".ep-autosuggest");return t.forEach((t=>{for(;t.firstChild;)t.removeChild(t.firstChild)})),e.forEach((t=>{t.style="display: none;"})),!0}function W(t,e){const r=e.closest("form");t?r.classList.add("is-loading"):r.classList.remove("is-loading")}M.endpointUrl&&""!==M.endpointUrl&&(!function(){const t=[M.defaultSelectors,M.selector].filter(Boolean).join(",");if(!t)return;let n,o;const i=[38,40,13],s=t=>{if(!i.includes(t.keyCode))return;const e=t.target,n=r(e,"ep-autosuggest-container").querySelector(".autosuggest-list").children,s=()=>Array.from(n).findIndex((t=>t.classList.contains("selected"))),a=()=>{Array.from(n).forEach((t=>{t.classList.remove("selected"),t.setAttribute("aria-selected","false")}))},u=()=>{if(o>=0){const t=n[o];t.classList.add("selected"),t.setAttribute("aria-selected","true"),G(t.id,e)}};switch(t.keyCode){case 38:o=o-1>=0?o-1:0,a();break;case 40:if("undefined"===typeof o)o=0;else{const t=s();n[t+1]&&(o=t+1,a())}break;case 13:n[o].classList.contains("selected")&&V(e,n[o].querySelector(".autosuggest-link"))}n[o]&&n[o].classList.contains("autosuggest-item")?u():a(),38===t.keyCode&&t.preventDefault()};function a(t){const e=new FormData(t);return e.has("post_type")?e.getAll("post_type").slice(-1):e.has("post_type[]")?e.getAll("post_type[]"):[]}const u=e((async t=>{const e=function(){if("undefined"===typeof window.epas){const t="No epas object defined";return console.warn(t),{error:t}}return window.epas}();if(e.error)return;const r=t.value,n="ep_autosuggest_placeholder",o=a(t.form);if(r.length>=2){W(!0,t);let i=X(r,n,e);o.length>0&&(i=JSON.parse(i),"undefined"!==typeof i.post_filter.bool.must&&i.post_filter.bool.must.push({terms:{"post_type.raw":o}}),i=JSON.stringify(i));const s=await z(i,r);if(s&&s._shards&&s._shards.successful>0){const e=function(t,e){const r={},n="ep_custom_result",o=e.toLowerCase(),i=t.filter((t=>{let e=!0;return void 0!==t._source.terms&&void 0!==t._source.terms[n]&&t._source.terms[n].forEach((n=>{n.name.toLowerCase()===o&&(r[n.term_order]=t,e=!1)})),e})),s={};Object.keys(r).sort().forEach((t=>{s[t]=r[t]})),Object.keys(s).length>0&&Object.keys(s).forEach((t=>{const e=s[t];i.splice(t-1,0,e)}));return i}(s.hits.hits,r);0===e.length?K():Q(e,t)}else K();W(!1,t)}else 0===r.length&&K()}),200),c=t=>{t.preventDefault();const{target:e,key:r,keyCode:n}=t;if("Escape"===r||"Esc"===r||27===n)return K(),function(t,e){e.setAttribute("aria-expanded",t)}(!1,e),void G("",e);if(i.includes(n)&&""!==e.value)return void s(t);const o=t.target;u(o)},l=t=>{const e=document.createElement("div");e.classList.add("ep-autosuggest-container"),t.insertAdjacentElement("afterend",e),e.appendChild(t)},f=t=>{if(!n){n=document.createElement("div"),n.classList.add("ep-autosuggest");const t=document.createElement("ul");t.classList.add("autosuggest-list"),t.setAttribute("role","listbox"),n.appendChild(t)}const e=n.cloneNode(!0);t.insertAdjacentElement("afterend",e)},d=t=>{if(t.classList.contains("facet-search"))return;t.setAttribute("autocomplete","off"),t.classList.contains("wp-block-search__input")?(t.form.classList.add("ep-autosuggest-container"),f(t.parentElement)):(l(t),f(t));const e=new CustomEvent("elasticpress.input.moved");t.dispatchEvent(e),t.addEventListener("keyup",c),t.addEventListener("blur",(function(){window.setTimeout(K,200)}))},h=e=>{const r=e.querySelectorAll(t);r&&Array.from(r).forEach(d)},p=()=>{const e=document.body,r={subtree:!0,childList:!0};new MutationObserver(((n,o)=>{n.forEach((n=>{Array.from(n.addedNodes).forEach((n=>{n.nodeType===Node.ELEMENT_NODE&&(o.disconnect(),"INPUT"===n.tagName?n.matches(t)&&d(n):h(n),o.observe(e,r))}))}))})).observe(e,r)};h(document.body),y=p,"undefined"!==typeof document&&("complete"!==document.readyState&&"interactive"!==document.readyState?document.addEventListener("DOMContentLoaded",y):y());var y}(),window.epasAPI={hideAutosuggestBox:K,updateAutosuggestBox:Q,esSearch:z,buildSearchQuery:X})}();