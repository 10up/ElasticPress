{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"jQuery\"","webpack:///external \"window\"","webpack:///./assets/js/dashboard.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","jQuery","window","_jquery","_window","$features","_jquery2","default","document","getElementsByClassName","$errorOverlay","$progressBar","$syncStatusText","$startSyncButton","$resumeSyncButton","$pauseSyncButton","$cancelSyncButton","syncStatus","featureSync","currentSyncItem","syncStack","processed","toProcess","updateSyncDash","text","css","width","parseInt","epDash","sync_initial","show","addClass","hide","sync_syncing","indexable","sync_indexable_labels","plural","toLowerCase","url","sync_paused","sync_wpcli","sync_error","removeClass","find","setTimeout","sync_complete","cancelSync","ajax","method","ajaxurl","data","action","nonce","sync","feature_sync","done","response","found_items","offset","sync_stack","current_sync_item","length","start","intro_shown","location","replace","ep_intro_url","error","status","on","this","parents","toggleClass","event","preventDefault","hasClass","feature","target","getAttribute","$feature","settings","each","type","attr","active","reindex","remove","index_meta","wpcli_sync","site_stack","auto_start_index","history","pushState","title","pathname","search"],"mappings":"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","file":"dashboard.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","module.exports = jQuery;","module.exports = window;","import jQuery from 'jquery';\nimport { ajaxurl, epDash } from 'window';\n\nconst $features = jQuery( document.getElementsByClassName( 'ep-features' ) );\nconst $errorOverlay = jQuery( document.getElementsByClassName( 'error-overlay' ) );\nconst $progressBar = jQuery( document.getElementsByClassName( 'progress-bar' ) );\nconst $syncStatusText = jQuery( document.getElementsByClassName( 'sync-status' ) );\nconst $startSyncButton = jQuery( document.getElementsByClassName( 'start-sync' ) );\nconst $resumeSyncButton = jQuery( document.getElementsByClassName( 'resume-sync' ) );\nconst $pauseSyncButton = jQuery( document.getElementsByClassName( 'pause-sync' ) );\nconst $cancelSyncButton = jQuery( document.getElementsByClassName( 'cancel-sync' ) );\n\nlet syncStatus = 'sync',\n\tfeatureSync = false,\n\tcurrentSyncItem,\n\tsyncStack,\n\tprocessed = 0,\n\ttoProcess = 0;\n\n$features.on( 'click', '.learn-more, .collapse', function() {\n\tjQuery( this ).parents( '.ep-feature' ).toggleClass( 'show-full' );\n} );\n\n$features.on( 'click', '.settings-button', function() {\n\tjQuery( this ).parents( '.ep-feature' ).toggleClass( 'show-settings' );\n} );\n\n$features.on( 'click', '.save-settings', function( event ) {\n\tevent.preventDefault();\n\n\tif ( jQuery( this ).hasClass( 'disabled' ) ) {\n\t\treturn;\n\t}\n\n\tconst feature = event.target.getAttribute( 'data-feature' );\n\tconst $feature = $features.find( '.ep-feature-' + feature );\n\tconst settings = {};\n\tconst $settings = $feature.find( '.setting-field' );\n\n\t$settings.each( function() {\n\t\tconst type = jQuery( this ).attr( 'type' );\n\t\tconst name = jQuery( this ).attr( 'data-field-name' );\n\t\tconst value = jQuery( this ).attr( 'value' );\n\n\t\tif ( 'radio' === type ) {\n\t\t\tif ( jQuery( this ).attr( 'checked' ) ) {\n\t\t\t\tsettings[ name ] = value;\n\t\t\t}\n\t\t} else {\n\t\t\tsettings[ name ] = value;\n\t\t}\n\t} );\n\n\t$feature.addClass( 'saving' );\n\n\tjQuery.ajax( {\n\t\tmethod: 'post',\n\t\turl: ajaxurl,\n\t\tdata: {\n\t\t\taction: 'ep_save_feature',\n\t\t\tfeature: feature,\n\t\t\tnonce: epDash.nonce,\n\t\t\tsettings: settings\n\t\t}\n\t} ).done( ( response ) => {\n\t\tsetTimeout( () => {\n\t\t\t$feature.removeClass( 'saving' );\n\n\t\t\tif ( '1' === settings.active ) {\n\t\t\t\t$feature.addClass( 'feature-active' );\n\t\t\t} else {\n\t\t\t\t$feature.removeClass( 'feature-active' );\n\t\t\t}\n\n\t\t\tif ( response.data.reindex ) {\n\t\t\t\tsyncStatus = 'initialsync';\n\n\t\t\t\tupdateSyncDash();\n\n\t\t\t\t// On initial sync, remove dashboard warnings that dont make sense\n\t\t\t\tjQuery( '[data-ep-notice=\"no-sync\"], [data-ep-notice=\"auto-activate-sync\"], [data-ep-notice=\"upgrade-sync\"]' ).remove();\n\n\t\t\t\tsyncStatus = 'sync';\n\n\t\t\t\t$feature.addClass( 'feature-syncing' );\n\n\t\t\t\tfeatureSync = feature;\n\n\t\t\t\tsync();\n\t\t\t}\n\t\t}, 700 );\n\t} ).error( () => {\n\t\tsetTimeout( () => {\n\t\t\t$feature.removeClass( 'saving' );\n\t\t\t$feature.removeClass( 'feature-active' );\n\t\t\t$feature.removeClass( 'feature-syncing' );\n\t\t}, 700 );\n\t} );\n} );\n\nif ( epDash.index_meta ) {\n\tif ( epDash.index_meta.wpcli_sync ) {\n\t\tsyncStatus = 'wpcli';\n\t\tupdateSyncDash();\n\t} else {\n\t\tprocessed = epDash.index_meta.offset;\n\t\ttoProcess = epDash.index_meta['found_items'];\n\n\t\tif ( epDash.index_meta.feature_sync ) {\n\t\t\tfeatureSync = epDash.index_meta.feature_sync;\n\t\t}\n\n\t\tif ( epDash.index_meta.current_sync_item ) {\n\t\t\tcurrentSyncItem = epDash.index_meta.current_sync_item;\n\t\t}\n\n\t\tif ( epDash.index_meta.site_stack ) {\n\t\t\tsyncStack = epDash.index_meta.sync_stack;\n\t\t}\n\n\t\tif ( syncStack && syncStack.length ) {\n\t\t\t// We are mid sync\n\t\t\tif ( epDash.auto_start_index ) {\n\t\t\t\tsyncStatus = 'sync';\n\n\t\t\t\thistory.pushState( {}, document.title, document.location.pathname + document.location.search.replace( /&do_sync/, '' ) );\n\n\t\t\t\tupdateSyncDash();\n\t\t\t\tsync();\n\t\t\t} else {\n\t\t\t\tsyncStatus = 'pause';\n\t\t\t\tupdateSyncDash();\n\t\t\t}\n\t\t} else {\n\t\t\tif ( 0 === toProcess && ! epDash.index_meta.start ) {\n\t\t\t\t// Sync finished\n\t\t\t\tsyncStatus = 'finished';\n\t\t\t\tupdateSyncDash();\n\t\t\t} else {\n\t\t\t\t// We are mid sync\n\t\t\t\tif ( epDash.auto_start_index ) {\n\t\t\t\t\tsyncStatus = 'sync';\n\n\t\t\t\t\thistory.pushState( {}, document.title, document.location.pathname + document.location.search.replace( /&do_sync/, '' ) );\n\n\t\t\t\t\tupdateSyncDash();\n\t\t\t\t\tsync();\n\t\t\t\t} else {\n\t\t\t\t\tsyncStatus = 'pause';\n\t\t\t\t\tupdateSyncDash();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n} else {\n\t// Start a new sync automatically\n\tif ( epDash.auto_start_index ) {\n\t\tsyncStatus = 'initialsync';\n\n\t\tupdateSyncDash();\n\n\t\tsyncStatus = 'sync';\n\n\t\thistory.pushState( {}, document.title, document.location.pathname + document.location.search.replace( /&do_sync/, '' ) );\n\n\t\tsync();\n\t}\n}\n\n/**\n * Update dashboard with syncing information\n */\nfunction updateSyncDash() {\n\tlet text;\n\n\tif ( 0 === processed ) {\n\t\t$progressBar.css( { width: '1%' } );\n\t} else {\n\t\tlet width = parseInt( processed ) / parseInt( toProcess ) * 100;\n\t\t$progressBar.css( { width: width + '%' } );\n\t}\n\n\tif ( 'initialsync' === syncStatus ) {\n\t\ttext = epDash.sync_initial;\n\n\t\t$syncStatusText.text( text );\n\n\t\t$syncStatusText.show();\n\t\t$progressBar.show();\n\t\t$pauseSyncButton.show();\n\t\t$errorOverlay.addClass( 'syncing' );\n\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$startSyncButton.hide();\n\t} else if ( 'sync' === syncStatus ) {\n\t\ttext = epDash.sync_syncing;\n\n\t\tif ( currentSyncItem ) {\n\t\t\tif ( currentSyncItem.indexable ) {\n\t\t\t\ttext += ' ' + epDash.sync_indexable_labels[ currentSyncItem.indexable ].plural.toLowerCase() + ' ' + parseInt( processed ) + '/' + parseInt( toProcess );\n\t\t\t}\n\n\t\t\tif ( currentSyncItem.url ) {\n\t\t\t\ttext += ' (' + currentSyncItem.url + ')';\n\t\t\t}\n\t\t}\n\n\t\t$syncStatusText.text( text );\n\n\t\t$syncStatusText.show();\n\t\t$progressBar.show();\n\t\t$pauseSyncButton.show();\n\t\t$errorOverlay.addClass( 'syncing' );\n\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$startSyncButton.hide();\n\t} else if ( 'pause' === syncStatus ) {\n\t\ttext = epDash.sync_paused;\n\n\t\tif ( toProcess && 0 !== toProcess ) {\n\t\t\ttext += ', ' + parseInt( processed ) + '/' + parseInt( toProcess ) + ' ' + epDash.sync_indexable_labels[ currentSyncItem.indexable ].plural.toLowerCase();\n\t\t}\n\n\t\tif ( currentSyncItem && currentSyncItem.url ) {\n\t\t\ttext += ' (' + currentSyncItem.url + ')';\n\t\t}\n\n\t\t$syncStatusText.text( text );\n\n\t\t$syncStatusText.show();\n\t\t$progressBar.show();\n\t\t$pauseSyncButton.hide();\n\t\t$errorOverlay.addClass( 'syncing' );\n\n\t\t$cancelSyncButton.show();\n\t\t$resumeSyncButton.show();\n\t\t$startSyncButton.hide();\n\t} else if ( 'wpcli' === syncStatus ) {\n\t\ttext = epDash.sync_wpcli;\n\n\t\t$syncStatusText.text( text );\n\n\t\t$syncStatusText.show();\n\t\t$progressBar.hide();\n\t\t$pauseSyncButton.hide();\n\t\t$errorOverlay.addClass( 'syncing' );\n\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$startSyncButton.hide();\n\t} else if ( 'error' === syncStatus ) {\n\t\t$syncStatusText.text( epDash.sync_error );\n\t\t$syncStatusText.show();\n\t\t$startSyncButton.show();\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$pauseSyncButton.hide();\n\t\t$errorOverlay.removeClass( 'syncing' );\n\t\t$progressBar.hide();\n\n\t\tif ( featureSync ) {\n\t\t\t$features.find( '.ep-feature-' + featureSync ).removeClass( 'feature-syncing' );\n\t\t}\n\n\t\tfeatureSync = null;\n\n\t\tsetTimeout( () => {\n\t\t\t$syncStatusText.hide();\n\t\t}, 7000 );\n\t} else if ( 'cancel' === syncStatus ) {\n\t\t$syncStatusText.hide();\n\t\t$progressBar.hide();\n\t\t$pauseSyncButton.hide();\n\t\t$errorOverlay.removeClass( 'syncing' );\n\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$startSyncButton.show();\n\n\t\tif ( featureSync ) {\n\t\t\t$features.find( '.ep-feature-' + featureSync ).removeClass( 'feature-syncing' );\n\t\t}\n\n\t\tfeatureSync = null;\n\t} else if ( 'finished' === syncStatus ) {\n\t\t$syncStatusText.text( epDash.sync_complete );\n\n\t\t$syncStatusText.show();\n\t\t$progressBar.hide();\n\t\t$pauseSyncButton.hide();\n\t\t$cancelSyncButton.hide();\n\t\t$resumeSyncButton.hide();\n\t\t$startSyncButton.show();\n\t\t$errorOverlay.removeClass( 'syncing' );\n\n\t\tif ( featureSync ) {\n\t\t\t$features.find( '.ep-feature-' + featureSync ).removeClass( 'feature-syncing' );\n\t\t}\n\n\t\tfeatureSync = null;\n\n\t\tsetTimeout( () => {\n\t\t\t$syncStatusText.hide();\n\t\t}, 7000 );\n\t}\n}\n\n/**\n * Cancel a sync\n */\nfunction cancelSync() {\n\tjQuery.ajax( {\n\t\tmethod: 'post',\n\t\turl: ajaxurl,\n\t\tdata: {\n\t\t\taction: 'ep_cancel_index',\n\t\t\tnonce: epDash.nonce\n\t\t}\n\t} );\n}\n\n/**\n * Perform an elasticpress sync\n */\nfunction sync() {\n\tjQuery.ajax( {\n\t\tmethod: 'post',\n\t\turl: ajaxurl,\n\t\tdata: {\n\t\t\taction: 'ep_index',\n\t\t\tfeature_sync: featureSync,\n\t\t\tnonce: epDash.nonce\n\t\t}\n\t} ).done( ( response ) => {\n\t\tif ( 'sync' !== syncStatus ) {\n\t\t\treturn;\n\t\t}\n\n\t\ttoProcess = response.data.found_items;\n\t\tprocessed = response.data.offset;\n\n\t\tif ( response.data.sync_stack ) {\n\t\t\tsyncStack = response.data.sync_stack;\n\t\t}\n\n\t\tif ( response.data.current_sync_item ) {\n\t\t\tcurrentSyncItem = response.data.current_sync_item;\n\t\t}\n\n\t\tif ( syncStack && syncStack.length ) {\n\t\t\t// We are mid multisite sync\n\t\t\tsyncStatus = 'sync';\n\t\t\tupdateSyncDash();\n\n\t\t\tsync();\n\t\t\treturn;\n\t\t}\n\n\t\tif ( 0 === response.data.found_items && ! response.data.start ) {\n\t\t\t// Sync finished\n\t\t\tsyncStatus = 'finished';\n\t\t\tupdateSyncDash();\n\n\t\t\tif( ! epDash.intro_shown ) {\n\t\t\t\tdocument.location.replace( epDash.ep_intro_url );\n\t\t\t}\n\n\t\t} else {\n\t\t\t// We are starting a sync\n\t\t\tsyncStatus = 'sync';\n\t\t\tupdateSyncDash();\n\n\t\t\tsync();\n\t\t}\n\t} ).error( ( response ) => {\n\t\tif ( response && response.status && 400 <= parseInt( response.status ) && 600 > parseInt( response.status ) ) {\n\t\t\tsyncStatus = 'error';\n\t\t\tupdateSyncDash();\n\n\t\t\tcancelSync();\n\t\t}\n\t} );\n\n}\n\n$startSyncButton.on( 'click', () => {\n\tsyncStatus = 'initialsync';\n\n\tupdateSyncDash();\n\n\t// On initial sync, remove dashboard warnings that dont make sense\n\tjQuery( '[data-ep-notice=\"no-sync\"], [data-ep-notice=\"auto-activate-sync\"], [data-ep-notice=\"upgrade-sync\"]' ).remove();\n\n\tsyncStatus = 'sync';\n\tsync();\n} );\n\n$pauseSyncButton.on( 'click', () => {\n\tsyncStatus = 'pause';\n\n\tupdateSyncDash();\n} );\n\n$resumeSyncButton.on( 'click', () => {\n\tsyncStatus = 'sync';\n\n\tupdateSyncDash();\n\n\tsync();\n} );\n\n$cancelSyncButton.on( 'click', () => {\n\tsyncStatus = 'cancel';\n\n\tupdateSyncDash();\n\n\tcancelSync();\n} );\n"],"sourceRoot":""}