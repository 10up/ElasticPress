jQuery(document).ready(function(a){var b=function(b,c){a(c).val(ep.running_index_text).removeClass("button-primary");var d=a("#progressbar"),e=a("#progressstats");if(d.show(),b){var f=0;parseInt(ep.total_posts)>0&&(f=parseFloat(ep.synced_posts)/parseFloat(ep.total_posts),e.html(ep.synced_posts+"/"+ep.total_posts+"items")),d.progressbar({value:100*f})}h(d,c,e)},c=0,d=0,e=0,f=0,g=function(){c=0,d=0,e=0},h=function(h,i,j){var k={action:"ep_launch_index",nonce:ep.nonce};a.ajax({url:ajaxurl,type:"POST",data:k,complete:function(k){var l="";0===k.responseJSON.data.is_network?(d=k.responseJSON.data.ep_posts_total,e=k.responseJSON.data.ep_posts_synced):(c!==k.responseJSON.data.ep_sites_remaining&&(c=k.responseJSON.data.ep_sites_remaining,d+=k.responseJSON.data.ep_posts_total,f++),l=f+ep.sites,e+=k.responseJSON.data.ep_current_synced);var m=parseFloat(e)/parseFloat(d);h.progressbar({value:100*m}),j.html(e+"/"+d+" "+ep.items_indexed+l),1==k.responseJSON.data.ep_sync_complete?(h.progressbar({value:100}),setTimeout(function(){a("#progressbar").fadeOut("slow"),a("#progressstats").html('Index complete <a href="">Refresh the stats</a>'),a("#ep_run_index").val(ep.index_complete_text).addClass("button-primary"),g()},1e3)):b(!1,i)}})},i=a("#ep_run_index");1==ep.index_running&&b(!0,i),i.click(function(c){c.preventDefault(),g();var d=this;a(d).hasClass("button-primary")&&b(!0,d)});var j=a("#ep_site_select");j.change(function(b){b.preventDefault(),console.log(j.val());var c={action:"ep_get_site_stats",nonce:ep.stats_nonce,site:j.val()};a.ajax({url:ajaxurl,type:"POST",data:c,complete:function(b){a("#ep_site_stats").html(b.responseJSON.data)}})})});