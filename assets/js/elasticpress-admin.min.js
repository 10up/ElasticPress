jQuery(document).ready(function(a){var b=function(b,d){a(d).val(ep.running_index_text).removeClass("button-primary");var e=a("#progressbar"),f=a("#progressstats");if(e.show(),b){var g=0;parseInt(ep.total_posts)>0?(g=parseFloat(ep.synced_posts)/parseFloat(ep.total_posts),f.html(ep.synced_posts+"/"+ep.total_posts+"items")):f.html(ep.counting_items),e.progressbar({value:100*g})}c(e,d,f)},c=function(c,d,e){var f={action:"ep_launch_index",nonce:ep.nonce};a.ajax({url:ajaxurl,type:"POST",data:f,complete:function(f){if("undefined"!=typeof f.responseJSON.data.ep_mapping_complete)e.html(ep.mapping_sites+"<br />"+f.responseJSON.data.ep_mapping_complete+" "+ep.sites_to_index),b(!1,d);else if(0==f.responseJSON.data.ep_sync_complete){var g=parseFloat(f.responseJSON.data.ep_posts_synced)/parseFloat(f.responseJSON.data.ep_posts_total);c.progressbar({value:100*g}),e.html(f.responseJSON.data.ep_posts_synced+"/"+f.responseJSON.data.ep_posts_total+" "+ep.items_indexed),b(!1,d)}else c.progressbar({value:100}),setTimeout(function(){a("#progressbar").fadeOut("slow"),a("#progressstats").html('Index complete <a href="">Refresh the stats</a>'),a("#ep_run_index").val(ep.index_complete_text).addClass("button-primary")},1e3)}})},d=a("#ep_run_index");1===ep.index_running&&b(!0,d),d.click(function(c){c.preventDefault();var d=this;a(d).hasClass("button-primary")&&b(!0,d)});var e=a("#ep_site_select");e.change(function(b){b.preventDefault();var c={action:"ep_get_site_stats",nonce:ep.stats_nonce,site:e.val()};a.ajax({url:ajaxurl,type:"POST",data:c,complete:function(b){console.log(a("#ep_site_stats")),a("#ep_site_stats").html(b.responseJSON.data)}})})});